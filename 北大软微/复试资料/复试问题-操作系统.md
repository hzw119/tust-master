1. PV操作是什么？ 

   是一种实现进程互斥和同步的有效方法，P操作表示资源申请通过，V表示释放资源。PV 操作是通过对semaphore信号量（数据结构）加一减一实现。

2. 进程和程序的区别：程序是**有序代码**的集合，进程是**程序**的执行
   1. 进程是动态的，程序是静态的
   2. 进程状态是暂时的，程序是永久的；进程是一个状态变化的过程，程序可以长久保存
   3. 组成不同，进程的组成包括**程序、数据和进程控制块PCB**(process control block)

   notes:
   
    **作业**（job）：用户需要计算机完成的某项任务。
   
   进程：程序段+相关数据+**PCB**
   
   **进程状态**： **就绪、执行、阻塞、挂起**
   
    除了资源外所有都准备就绪：就绪态
   
    获得需要的资源：执行态
   
    执行过程中由于需要的资源被其他资源占用：阻塞态
   
     将**内存**的进程对换至**外存**：**挂起**态 ==》活动就绪、静止就绪（对换至外存）、活动阻塞、静止阻塞
   
   <img src="D:\project\tust-master\北大软微\img\进程状态.png" alt="进程状态" style="zoom:50%;" />
   
3. **饥饿与死锁**

   饥饿：系统不能按时满足进程需求，而使得进程长时间等待。

   死锁：每一个持有资源的进程之间相互等待，形成闭环。

   预防死锁（破坏死锁的四个必要条件）、避免死锁（银行家算法）、解除死锁（资源剥夺法、撤销进程法、进程回退法）、**检测死锁**（**资源有向图**）

   死锁的四个必要条件：

   1. 互斥
   2. 请求和保持条件:一次性申请所有资源
   3. 不剥夺条件：对资源可以抢占
   4. 循环等待条件：按照资源的编号从小到大的申请资源

   饥饿与死锁的相同点：都是由于资源**竞争**引起的

   饥饿与死锁的**不同点：**

   1. 死锁一定发生了**循环等待**，饿死则不然
   2. 死锁进程**都**处于**等待**状态，饥饿的进程并非处于等待状态，而是处于**就绪**状态。
   3.   死锁一定涉及多个进程，而饥饿或被饿死的进程可能只有一个。

4. 进程与线程（Thread）的区别：

   1. 进程**分配资源**，线程**分配CPU**。
   2. 不同进程之间有自己独立的地址空间，进程切换开销昂贵，**同一进程的线程**有相同的**地址空间**，线程切换开销较低。
   3. 线程之间的**通信更方便**，进程之间的通信需要以通信的方式（IPC)进行。
   4. 线程共享资源，进程不共享资源。
   
   **google：新开页面是一个新的进程**


5. 进程调度算法

   （1）先来先服务
   （2）**短作业优先**
   （3）**优先级调度算法**
   （4）**高响应比**：周转时间/运行时间     周转时间=运行时间+等待时间
   （5）时间片轮转
   （6）多级反馈队列调度

6. 局部性原理
   （1）时间局部性
   （2）空间局部性 

7. **微内核（windows、MAC）：操作与策略分离，但是需要频繁的在用户态和核心态间进行切换**，易拓展、好维护

   **宏内核（类Unix系统）**将基础系统操作都封装在了内核中，不易拓展且结构庞杂。

8. **虚拟内存**

   **含义：**

   1. 基于局部性原理，在程序装入时，可以将程序的一部分装入内存，而将剩余的一部分放在外存，在程序执行过程中，当所访问的信息不在内存时，将操作系统所需要的部分调入内存。

   2. 系统将不常使用的内容换出到外存中，从而腾出空间放其他即将调入内存的信息。

   虚拟存储器：（1）**多次性（一个进程可能被多次调用进了内存）**（2）**对换性（内存和外存的对换）**（3）虚拟性（逻辑意义上增加了内存）
   **实现方式**：请求分页存储管理，请求分段存储管理，请求段页式

   **TLB**; translation look aside buffer高速缓冲存储器, 又称联想存储器, 也称**快表**技术

   **分页和分段的区别**

   1. 页是**信息的物理单位**，是系统的需要；段则是**信息的逻辑单位**，是为了满足用户的需要.

   2. 页的大小固定且有系统决定，而段长度可变，取决于用户编写的程序
   3. 分页的作业地址空间**一维**，单一线性地址空间；分段的作业地址空间是**二维**的，要给出段号和段内地址

   **页面置换算法**：最佳置换算法（OPT）先进先出（FIFO **Balady现象**）最近最久未使用（LRU least recently used）**时钟**（clock）（NRU）
   **页面分配策略**：固定分配局部置换 可变分配全局置换 可变分配局部置换

9. I/O控制方式
   1. 轮询方式
   
   2. 中断
   
3. DMA:建立IO与内存之间的直接通道，传送**单位数据块**
   
4. Channel：通道
   
   ## 中断
   
   **中断的分类：**
   
     外中断 VS 内中断
   
   外中断：来自处理器和内存**以外的部件**引起的中断，包括I/O设备发出的**I/O中断**、**外部信号中断**、**以及各种定时器中断**等
   
   内中断：处理器和内存内部产生的中断，包括程序运算引起的各种错误，如地址非法、检验错、页面失效。
   
      硬中断和软中断
   
   **硬**中断：硬中断是由硬件产生的、直接中断CPU，不可以被打断
   
      ​       硬件->CPU->内核中的设备驱动程序
   
   **软**中断：正在运行的进程所产生的、不会直接中断CPU，可以被打断
   
      ​       软件->内核中的设备驱动程序
   
   
   
      **中断需要保存现场信息，都需要保存什么？**
   
      PC(程序计数器)、PSW(程序**状态**字)、各种通用寄存器==>**中断现场栈**
   
      中断过程：中断**请求**、中断响应、断点保护、执行中断服务程序、断点**恢复** 中断返回
   
10. ## 中断机制

    中断：指某个事件（内部、外部）发生时，在当前指令周期结束后，系统中止现行程序而去处理该事件的机制。

    中断机制的**产生原因**:中断是多程序**并发执行**的前提条件，提高CPU的利用率

    中断的**本质**：发生中断就意味着需要操作系统介入，开展管理，**用户态**到**核心态**的转换就是通过中断机制实现的，并且中断是**唯一途径**。

12. 系统调用（trap 陷入）

    是应用程序同系统之间的**接口**，用户程序为了使用操作系统所提供的一些高权限的功能。

    是用户在程序中调用操作系统所执行的一些子功能，系统调用可以被看作成特殊的公共子程序。

    访问系统资源的操作**必须经过**系统调用。

    **设备管理 文件管理 内存管理 进程控制 进程通信**

    中断 VS. 系统调用

     系统调用属于内中断的一种，是一种**有意的中断**

13. 内存分配方式
    
    连续方式：
    
1. 单一分配：只针对于单一的进程
    2.  固定分区分配
    3. 动态分区分配:首次适应 循环首次适应 最佳适应 **最坏适应**
    
    离散方式：
    
      分页、分段、段页
    
15. 管程

     **定义**：一组数据以及定义在这组数据之上对这组数据的操作组成的软件模块，这组操作能初始化并改变管程中的数据和同步进程。

    **组成**：1）局部于管程的共享结构数据说明
                2）对该数据结构进行操作的一组过程
                3）对局部于管程的共享数据设置初始值的语句

    **特性**：局部于管程的数据只能被局部于管程内的过程所访问
                一个进程只能通过调用管程内的过程才能进入管程访问共享数据
               每次仅允许一个进程在管程内执行某个内部过程。

16. **程序链接方式**：静态 装入时动态 运行时动态

    **程序装入**：绝对装入 **可重定位**装入 动态运行时装入

    覆盖：把即将要访问的放入覆盖区，其他段放在外存中，在需要调用前，系统再将其调入覆盖区，替换覆盖区原有的段

    交换：把**处于等待状态的程序**从内存移到辅存，在内存空间腾出来

    **覆盖VS 交换**

    1. 交换主要是在进程和作业之间进行
    2. 覆盖主要在同一程序或作业中进行


15. DMA（**Direct Memory Access**） vs **中断方式**
    1. DMA处理的数据是块数据，中断方式处理的是字节数据.
    2. 中断方式涉及程序的切换，需要保护和恢复现场；而DMA方式除了预处理和后处理，其余时间不占用CPU
    3. 中断方式的数据传送需要CPU的干预，而DMA传送不需要CPU的参与
    
16. DMA vs 通道
    1. 通道处理的数据是多块,而DMA处理的数据是单块.
    2. 通道是弱版的没有独立地址空间的CPU,CPU会向通道传递通道程序的地址和目标内存的地址,此后CPU就不再干预此次数据传输,而DMA需要CPU的预处理和后处理,

18. FCB文件控制块

    1. 文件指针：上次读写位置

    2. **文件打开数**
    3. **文件磁盘位置(**物理位置)
    4. 访问权限：创建、只读、读写等

19. **open**

    将磁盘上的**目录文件(FCB)信息**复制到**打开文件表**，返回一个指向**打开文件表**一个条目的指针（接下来的文件操作都根据这个指针操作文件）。

20. 从磁盘 read/write 文件：

    1. 调用**库函数**向内核发起读文件请求
    2. 内核通过进程的**文件描述符**定位到系统的打开文件表
    3. 调用该文件可用的系统调用函数read()
    4. read()找到**磁盘上的i node**，计算文件内容偏移量计算出要读取的页。
    5. 文件内容读取成功。

20. 文件系统：**在存储设备上组织/管理文件的方法**

    windows、Linux的文件系统：

    windows ：FAT(12,16,32)、NTFS(windows NT),NTFS相较于FAT比较安全和稳定。

    Linux: EXT2/3 系统

    文件系统想打开一个文件有哪些**过程**：

    将相应文件的**FCB 读入内存中**，并且返回一个**文件描述符**，填入**系统打开文件表**，接下来的文件操作都将会通过这个文件描述符直接找到内存中的FCB，然后进行操作。

    删除一个文件：找到这个文件，从磁盘上删除，删除内存中的I node和目录项。

22. 进程通信(**高级**通信方式)
    1. 共享内存：顾名思义，共享内存就是两个进程同时共享一块内存
    2. pipe方式：pipe是一种二进制文件，**半双工通信**
    3. 消息队列：message queue
    4. 信号量 semaphore（**低级**通信方式）
    
23. 内存交换：换入、换出

    把处于等待状态的程序从内存移到辅存：换出

    把准备好运行的程序从辅存移到内存这一过程：换入

    linux swap分区的作用

    ​     当系统运行时的**物理内存**不够时，会将一些长时间没有任何操作的程序**换出**到swap分区里边

24. **进程控制块PCB**

    一种数据结构，主要表示进程状态，其作用是使一个不能独立运行的程序变成独立运行的进程。

    组成：

    1.  进程**标识**信息，比如进程ID、所属用户ID
    2. 进程**控制**信息，进程调度信息，进程通信机制。
    3. 进程**资源**信息,打开的文件、进程地址空间
    4. CPU**状态**信息


24. UNIX的文件管理-- I node

    UNIX下，我们可以通过操作一个文件的**I node**查看和管理这个文件。

    **I node** 存储**元信息**：文件的权限、长度、磁盘中的位置和修改时间

    分为磁盘i node、内存i node

    当一个文件被创建时，系统会分配一个i node给它，**文件名和i node**连接在一起，i node 会和文件内容联系在一起

25. 文件管理：系统组织文件的方式

    数据分为：数据项、记录、文件

    文件系统管理的对象：文件、目录、磁盘

    文件的属性：名称、标识符、类型、位置、大小等

    open系统调用：打开是指系统将文件的FCB从外存拷贝到内存中，并返回一个**文件描述符**。

    文件的逻辑结构：从**用户角度**看文件的组织方式：无结构文件（流式文件）、有结构文件（记录式文件）

    ​    有结构文件 又分为：顺序文件、索引文件、Hash文件、直接文件

    文件的物理结构：文件在**外存上的存储组织**方式 

      文件的存储设备通常划分为大小相同的**物理块**，物理块是分配和传输信息的**基本单位**。

     文件组织方式：

    1. 顺序分配：分配一组连续的物理块，然后，按照逻辑文件中的信息顺序，依次存放在物理块中。**存取速度最快**，但是文件建立时必须指定文件的长度，以后不能动态增长，一般不宜用于需要经常修改的文件。

    2. 链接分配：可以分配一组不连续的物理块，可以动态增长，提高了存储空间的利用率，但是查询效率低（只允许顺序查询）。

       显式链接分配：FAT表

       隐式链接分配：指针

    3. 索引分配：为每一个文件建立一张**索引表**，索引表中每一表项指向下一级索引表项和与之对应的物理块号。

       ![文件索引分配](C:\Users\Administrator\Desktop\ms\文件索引分配.png)

    支持动态增加，支持顺序存取，随机存取，缺点是索引表增加了存储空间的开销。**访问磁盘次数的计算**

    文件目录管理：实现按名存取、提高对目录检索速度等

    目录结构：单级目录、两级目录、多级目录结构

    **文件存储设备管理**：索引法、链接法、**位示图**

    **空闲盘块**的组织和分配方法：有空闲表法，空闲链表法、位示图、**成组链接法**

    

26. 计算机系统中提高并行性的技术有哪些
    1. 时间重叠：多个处理过程在时间上相互错开，同一时间重叠使用不同的硬件设备
    2. 资源重叠：通过重复设置相同资源，尤其是硬件资源
    3. 资源**共享**：是一种软件方法

27. 磁盘调度算法

    （1）FCFS(first come first service )先来先服务
    （2）SSTF (short seek time first)最短寻道时间优先
    （3）SCAN扫描算法 电梯算法
    （4）C-SCAN 循环扫描

28. 系统软件 vs 应用软件

    **系统软件**负责管理计算机系统中各种**独立的硬件**

    应用软件是为了某种**特定的用途**而被开发的软件

    操作系统**控制和调度**整个计算机系统的硬件和软件资源（**操作系统的作用**）

    硬件->操作系统->**数据库系统**->应用软件

    **操作系统的层次结构**：硬件、操作系统、应用软件

29. Spooling 技术

    通过多道程序技术将**一台独占物理设备**虚拟为**多台逻辑设备**

![spooling](C:\Users\Administrator\Desktop\ms\spooling.jpg)

​       输入输出井：是**磁盘**上开辟的两大存储区，

​       输入进程和输出进程：模拟脱机输入/输出的外围控制机

​       输入缓冲、输出缓冲区：**内存上**开辟的两大存储区

30. **开机的过程**

    1. DIOS
    2. 加载引导程序，超级块
    3. 加载数据结构

31. **I/O 子系统的层次结构**

    从上到下分别为：硬件设备、中断处理程序、设备驱动程序、设备独立性软件